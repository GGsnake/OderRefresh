<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.neo.dao.TbOderDao">
    <resultMap id="BaseResultMap" type="com.neo.model.TboderBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" property="id" jdbcType="INTEGER"/>
        <result column="adzone_id" property="adzoneId" jdbcType="BIGINT"/>
        <result column="adzone_name" property="adzoneName" jdbcType="VARCHAR"/>
        <result column="alipay_total_price" property="alipayTotalPrice" jdbcType="VARCHAR"/>
        <result column="commission" property="commission" jdbcType="INTEGER"/>
        <result column="commission_rate" property="commissionRate" jdbcType="VARCHAR"/>
        <result column="order_type" property="orderType" jdbcType="VARCHAR"/>
        <result column="item_title" property="itemTitle" jdbcType="VARCHAR"/>
        <result column="item_num" property="itemNum" jdbcType="INTEGER"/>
        <result column="num_iid" property="numIid" jdbcType="INTEGER"/>
        <result column="pay_price" property="payPrice" jdbcType="VARCHAR"/>
        <result column="price" property="price" jdbcType="VARCHAR"/>
        <result column="tk_status" property="tkStatus" jdbcType="TINYINT"/>
        <result column="site_id" property="siteId" jdbcType="VARCHAR"/>
        <result column="site_name" property="siteName" jdbcType="VARCHAR"/>
        <result column="total_commission_rate" property="totalCommissionRate" jdbcType="VARCHAR"/>
        <result column="trade_id" property="tradeId" jdbcType="INTEGER"/>
        <result column="trade_parent_id" property="tradeParentId" jdbcType="INTEGER"/>
        <result column="odercreate_time" property="odercreateTime" jdbcType="TIMESTAMP"/>
        <result column="createTime" property="createtime" jdbcType="TIMESTAMP"/>
        <result column="updateTime" property="updatetime" jdbcType="TIMESTAMP"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        id, adzone_id, adzone_name, alipay_total_price, commission, commission_rate, order_type,
        item_title, item_num, num_iid, pay_price, price, tk_status, site_id, site_name, total_commission_rate,
        trade_id, trade_parent_id, odercreate_time, createTime, updateTime
    </sql>
    <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        select
        <include refid="Base_Column_List"/>
        from tboder
        where id = #{id,jdbcType=INTEGER}
    </select>
    <select id="selectPidIn" resultType="java.lang.Integer">
        select
        SUM(commission)
        from tboder
        <if test="list!= null">
            WHERE adzone_id in
            <foreach item="item" index="index" collection="list" open="(" separator="," close=")">
                #{item}
            </foreach>
        </if>
        and tk_status =12
    </select>
    <update id="taoBaoUpdate" parameterType="com.neo.model.TboderBean">
        update tboder
        <set>
            <if test="adzone_id != null">
                adzone_id = #{adzoneId},
            </if>
            <if test="settle != null">
                settle = #{settle},
            </if>
            <if test="createtime != null">
                createTime = #{createtime,jdbcType=TIMESTAMP},
            </if>
            updateTime = now()
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>

    <insert id="insert" parameterType="com.neo.model.TboderBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into tboder (adzone_id, adzone_name,
        alipay_total_price, commission, commission_rate,
        order_type, item_title, item_num,
        num_iid, pay_price, price,
        tk_status, site_id, site_name,
        total_commission_rate, trade_id, trade_parent_id,
        odercreate_time, createTime
        )
        values (#{adzoneId,jdbcType=BIGINT}, #{adzoneName,jdbcType=VARCHAR},
        #{alipayTotalPrice,jdbcType=VARCHAR}, #{commission}, #{commissionRate,jdbcType=VARCHAR},
        #{orderType,jdbcType=VARCHAR}, #{itemTitle,jdbcType=VARCHAR}, #{itemNum,jdbcType=INTEGER},
        #{numIid,jdbcType=INTEGER}, #{payPrice,jdbcType=VARCHAR}, #{price,jdbcType=VARCHAR},
        #{tkStatus,jdbcType=TINYINT}, #{siteId,jdbcType=VARCHAR}, #{siteName,jdbcType=VARCHAR},
        #{totalCommissionRate,jdbcType=VARCHAR}, #{tradeId}, #{tradeParentId},
        #{odercreateTime},now()
        )
    </insert>
    <insert id="insertSelective" parameterType="com.neo.model.TboderBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into tboder
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">
                id,
            </if>
            <if test="adzoneId != null">
                adzone_id,
            </if>
            <if test="adzoneName != null">
                adzone_name,
            </if>
            <if test="alipayTotalPrice != null">
                alipay_total_price,
            </if>
            <if test="commission != null">
                commission,
            </if>
            <if test="commissionRate != null">
                commission_rate,
            </if>
            <if test="orderType != null">
                order_type,
            </if>
            <if test="itemTitle != null">
                item_title,
            </if>
            <if test="itemNum != null">
                item_num,
            </if>
            <if test="numIid != null">
                num_iid,
            </if>
            <if test="payPrice != null">
                pay_price,
            </if>
            <if test="price != null">
                price,
            </if>
            <if test="tkStatus != null">
                tk_status,
            </if>
            <if test="siteId != null">
                site_id,
            </if>
            <if test="siteName != null">
                site_name,
            </if>
            <if test="totalCommissionRate != null">
                total_commission_rate,
            </if>
            <if test="tradeId != null">
                trade_id,
            </if>
            <if test="tradeParentId != null">
                trade_parent_id,
            </if>
            <if test="odercreateTime != null">
                odercreate_time,
            </if>
            <if test="createtime != null">
                createTime,
            </if>
            <if test="updatetime != null">
                updateTime,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="id != null">
                #{id,jdbcType=INTEGER},
            </if>
            <if test="adzoneId != null">
                #{adzoneId,jdbcType=INTEGER},
            </if>
            <if test="adzoneName != null">
                #{adzoneName,jdbcType=VARCHAR},
            </if>
            <if test="alipayTotalPrice != null">
                #{alipayTotalPrice,jdbcType=VARCHAR},
            </if>
            <if test="commission != null">
                #{commission,jdbcType=VARCHAR},
            </if>
            <if test="commissionRate != null">
                #{commissionRate,jdbcType=VARCHAR},
            </if>
            <if test="orderType != null">
                #{orderType,jdbcType=VARCHAR},
            </if>
            <if test="itemTitle != null">
                #{itemTitle,jdbcType=VARCHAR},
            </if>
            <if test="itemNum != null">
                #{itemNum,jdbcType=INTEGER},
            </if>
            <if test="numIid != null">
                #{numIid,jdbcType=INTEGER},
            </if>
            <if test="payPrice != null">
                #{payPrice,jdbcType=VARCHAR},
            </if>
            <if test="price != null">
                #{price,jdbcType=VARCHAR},
            </if>
            <if test="tkStatus != null">
                #{tkStatus,jdbcType=TINYINT},
            </if>
            <if test="siteId != null">
                #{siteId,jdbcType=VARCHAR},
            </if>
            <if test="siteName != null">
                #{siteName,jdbcType=VARCHAR},
            </if>
            <if test="totalCommissionRate != null">
                #{totalCommissionRate,jdbcType=VARCHAR},
            </if>
            <if test="tradeId != null">
                #{tradeId,jdbcType=INTEGER},
            </if>
            <if test="tradeParentId != null">
                #{tradeParentId,jdbcType=INTEGER},
            </if>
            <if test="odercreateTime != null">
                #{odercreateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="createtime != null">
                #{createtime,jdbcType=TIMESTAMP},
            </if>
            <if test="updatetime != null">
                #{updatetime,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.neo.model.TboderBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update tboder
        <set>
            <if test="adzoneId != null">
                adzone_id = #{adzoneId},
            </if>
            <if test="adzoneName != null">
                adzone_name = #{adzoneName,jdbcType=VARCHAR},
            </if>
            <if test="alipayTotalPrice != null">
                alipay_total_price = #{alipayTotalPrice,jdbcType=VARCHAR},
            </if>
            <if test="commission != null">
                commission = #{commission,jdbcType=VARCHAR},
            </if>
            <if test="commissionRate != null">
                commission_rate = #{commissionRate,jdbcType=VARCHAR},
            </if>
            <if test="orderType != null">
                order_type = #{orderType,jdbcType=VARCHAR},
            </if>
            <if test="itemTitle != null">
                item_title = #{itemTitle,jdbcType=VARCHAR},
            </if>
            <if test="itemNum != null">
                item_num = #{itemNum,jdbcType=INTEGER},
            </if>
            <if test="numIid != null">
                num_iid = #{numIid,jdbcType=INTEGER},
            </if>
            <if test="payPrice != null">
                pay_price = #{payPrice,jdbcType=VARCHAR},
            </if>
            <if test="price != null">
                price = #{price,jdbcType=VARCHAR},
            </if>
            <if test="tkStatus != null">
                tk_status = #{tkStatus,jdbcType=TINYINT},
            </if>
            <if test="siteId != null">
                site_id = #{siteId,jdbcType=VARCHAR},
            </if>
            <if test="siteName != null">
                site_name = #{siteName,jdbcType=VARCHAR},
            </if>
            <if test="totalCommissionRate != null">
                total_commission_rate = #{totalCommissionRate,jdbcType=VARCHAR},
            </if>
            <if test="tradeId != null">
                trade_id = #{tradeId,jdbcType=INTEGER},
            </if>
            <if test="tradeParentId != null">
                trade_parent_id = #{tradeParentId,jdbcType=INTEGER},
            </if>
            <if test="odercreateTime != null">
                odercreate_time = #{odercreateTime,jdbcType=TIMESTAMP},
            </if>
            <if test="createtime != null">
                createTime = #{createtime,jdbcType=TIMESTAMP},
            </if>
            <if test="updatetime != null">
                updateTime = #{updatetime,jdbcType=TIMESTAMP},
            </if>
        </set>
        where id = #{id,jdbcType=INTEGER}
    </update>
    <update id="oderUpdate" parameterType="com.neo.model.TboderBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update tboder
        <set>

            <if test="tb.commission != null">
                commission = #{tb.commission,jdbcType=BIGINT},
            </if>
            <if test="tb.commissionRate != null">
                commission_rate = #{tb.commissionRate,jdbcType=VARCHAR},
            </if>

            <if test="tb.tkStatus != null">
                tk_status = #{tb.tkStatus,jdbcType=TINYINT},
            </if>
            updateTime=now()

        </set>
        where trade_id = #{tb.tradeId}
    </update>

    <insert id="saveTbOderAdvice" parameterType="com.neo.model.SysJhAdviceOder" useGeneratedKeys="true"
            keyProperty="id">
		insert into jh_advice_oder
		(
			`userId`,
			`oderSn`,
			`src`,
			`src_name`,
			`name`,
			`pid`,
			`order_status`,
			`order_status_desc`,
			`oder_createTime`,
			`userName`,
			`createTime`
		)
		values
		(
			#{userid},
			#{odersn},
			#{src},
			#{srcName},
			#{name},
			#{pid},
			#{orderStatus},
			#{orderStatusDesc},
			#{oderCreatetime},
			#{userName},
			now()
		)
	</insert>

    <select id="queryUserForPid" resultType="com.neo.model.Userinfo">
        SELECT id,userName,createTime FROM userinfo
        <where>
            <if test="pddpid != null">
                And pddPid = #{pddpid}
            </if>
            <if test="tbpid!= null">
                And tbPid = #{tbpid}
            </if>
            <if test="jdpid!= null">
                And jdPid = #{jdpid}
            </if>
        </where>
        and status=0   limit 1
    </select>
</mapper>